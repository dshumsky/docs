filebeat.inputs:
  - type: container
    paths:
      - '/var/lib/docker/containers/*/*.log'
    containers.ids: '*'
    processors:
      - decode_json_fields:
          fields:
            - message
          target: json
      - add_docker_metadata: ~
      # - include_fields:
      #     fields:
      #       - container.name
      - drop_event:
          when:
            not:
              or:
                - has_fields:
                    - json.message
                - regexp:
                    container.name: ".*logging_container.*"
      - drop_fields:
          when:
            has_fields:
              - json.message
          fields:
            - message
      - rename:
          when:
            has_fields:
              - json.message
          fields:
            - from: "json.message"
              to: "message"

output:
  logstash:
    loadbalance: true
    hosts: ["localhost:12220"]

logging:
  json: true
